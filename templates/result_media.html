<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Transcription Result</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f4f7fa; min-height:100vh; }
    .card { border-radius: 1rem; box-shadow: 0 4px 10px rgba(0,0,0,.15); }
    pre { white-space: pre-wrap; background:#222; color:#eee; padding:1rem; border-radius:.5rem; max-height:400px; overflow:auto; }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="text-center mb-4">
      <h1>Transcription Result</h1>
      <p class="text-muted">{{ version }}</p>
      <a href="{{ url_for('download', token=token_txt) }}" class="btn btn-success btn-lg me-2">‚¨á Transcript (.txt)</a>
      <a href="{{ url_for('download', token=token_srt) }}" class="btn btn-primary btn-lg me-2">‚¨á Subtitles (.srt)</a>
      <a href="{{ url_for('download', token=token_json) }}" class="btn btn-dark btn-lg me-2">‚¨á Verification (.json)</a>
      <a href="{{ url_for('index') }}" class="btn btn-outline-secondary btn-lg">‚Üê Back</a>
    </div>

    <!-- üîπ Speaker info badges -->
    <div class="text-center mb-3">
      {% if meta and meta.enabled %}
        <span class="badge text-bg-dark">Speakers: {{ meta.count }}</span>
        <span class="badge text-bg-secondary">{{ meta.speakers | join(", ") }}</span>
      {% else %}
        <span class="badge text-bg-warning">Diarization: Off</span>
      {% endif %}
    </div>

    <div class="card mb-4">
      <div class="card-body">
        <h4 class="card-title">üìú Transcript</h4>
        <pre>{{ transcript }}</pre>
      </div>
    </div>

    {% if summary %}
    <div class="card mb-4">
      <div class="card-body">
        <h4 class="card-title">‚ú® Summary</h4>
        <p class="card-text" style="white-space: pre-wrap;">{{ summary }}</p>
      </div>
    </div>
    {% endif %}

    {% if verification %}
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">üîç Verification Report</h4>
        <ul class="mb-2">
          <li><strong>Duration:</strong> {{ verification.duration_sec }} sec</li>
          <li><strong>Avg chars/sec:</strong> {{ verification.avg_chars_per_sec }}</li>
          <li><strong>Suspicious speed:</strong> {{ verification.suspicious_speed_flag }}</li>
          <li><strong>Long silences (count):</strong> {{ verification.silence_segments_over_3s | length }}</li>
        </ul>
        <details class="mt-2">
          <summary>See full JSON</summary>
          <pre class="mt-3">{{ verification | tojson(indent=2) }}</pre>
        </details>
        <p class="small text-muted mt-3">{{ verification.notes[0] }}</p>
      </div>
    </div>
    {% endif %}
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>